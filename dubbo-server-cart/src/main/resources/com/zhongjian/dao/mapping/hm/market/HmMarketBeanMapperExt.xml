<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.zhongjian.dao.entity.hm.market.HmMarketBean">
    <resultMap id="BaseMarket" type="com.zhongjian.dto.hm.market.result.HmMarketResultDTO">
        <id column="id" property="martketId"/>
        <result column="ename" property="marketName" jdbcType="VARCHAR"/>
        <association property="hmMarketActivityResultDTO" column="id"
                     select="com.zhongjian.dao.entity.hm.market.HmMarketActivityBean.findActitityById">
        </association>

        <collection property="hmShopownResultDTOS" column="id"
                    select="com.zhongjian.dao.entity.hm.shopown.HmShopownBean.findShopownInfoByMarketId">
        </collection>
    </resultMap>

    <select id="findMarketByUid" parameterType="java.lang.Integer" resultMap="BaseMarket">
        SELECT
        DISTINCT
            (m.id),
            m.ename
        FROM
            hm_market m
        LEFT JOIN hm_shopown s ON m.id = s.marketid
        LEFT JOIN hm_goods g ON g.pid = s.pid
        LEFT JOIN hm_basket b ON b.gid = g.id
        where b.uid=#{uid.jdbcType=INTEGER}
        and m.is_delete=1

    </select>
</mapper>